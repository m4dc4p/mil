\documentclass[12pt]{report}
%include polycode.fmt
\include{preamble.f}
\begin{document}
\ifthenelse{\boolean{standaloneFlag}}
           {\doublespacing}{}
           \chapter{Languages}

\emph{Defines the languages used in the thesis and a simple
  compilation scheme from a \lamA variant to our monadic language. }

\section{Source Language}

\emph{Defines a \lamA variant with some monadic effects, enough to
  illustrate interesting programs.}

\section{Monadic Intermediate Language}

%% What does the language support?

%% Syntax

\begin{code}
data StmtM e x where
  BlockEntry :: Name -> Label -> [Name] -> StmtM C O
  CloEntry :: Name -> Label -> [Name] -> Name -> StmtM C O
  Bind :: Name -> TailM -> StmtM O O
  CaseM :: Name -> [Alt TailM] -> StmtM O C
  Done :: TailM -> StmtM O C

data TailM = Return Name 
  | Enter Name Name
  | Closure Dest [Name]
  | Goto Dest [Name] 
  | ConstrM Constructor [Name]
  deriving (Eq, Show)
\end{code}

\emph{Defines our monadic language and explains the terms in
  it. Example programs are given which illustrate closure construction
  and data allocation. The use of ``tail'' vs. statements is motivated
  and described. }

\emph{Need to talk about the monad we work in as well - what 
do bind and return mean?}

\section{Compiling to Our MIL}
\emph{A compilation scheme which uses Hoopls ``shapes'' is
described. This scheme will give use our initial, unoptimized
MIL program. An example (possibly |compose|, or |const3|) illustrates 
our scheme.}

\end{document}
